server:
  port: 8080
  mode: debug
  cors:
    allow_all_origins: true
    allowed_origins: []

database:
  driver: postgres
  path: ./data/memes.db
  port: 6543
  user: postgres
  dbname: emomo
  sslmode: disable
  auto_migrate: true
  max_idle_conns: 10
  max_open_conns: 100
  conn_max_lifetime: 1h

qdrant:
  port: 6334
  collection: emomo  # Default collection name (fallback)

storage:
  type: r2
  # endpoint: set via STORAGE_ENDPOINT env var
  endpoint: ""
  use_ssl: true
  bucket: emomo
  region: auto
  # public_url: set via STORAGE_PUBLIC_URL env var
  public_url: ""

vlm:
  provider: openai
  # model: set via VLM_MODEL env var
  model: ""
  base_url: https://openrouter.ai/api/v1

# Embedding configurations (list format)
# Each embedding can have its own provider, model, and Qdrant collection
embeddings:
  - name: jina
    provider: jina
    model: jina-embeddings-v3
    api_key_env: JINA_API_KEY
    dimensions: 1024
    collection: emomo

  - name: qwen3
    provider: modelscope
    model: Qwen/Qwen3-Embedding-8B
    api_key_env: MODELSCOPE_API_KEY
    base_url_env: MODELSCOPE_BASE_URL
    dimensions: 4096
    collection: emomo_v2
    is_default: true

ingest:
  workers: 5
  batch_size: 10
  retry_count: 3

search:
  score_threshold: 0.35
  query_expansion:
    enabled: true
    # model: set via QUERY_EXPANSION_MODEL env var
    model: ""
    # api_key: set via QUERY_EXPANSION_API_KEY env var (optional, defaults to VLM's OPENAI_API_KEY)
    api_key: ""
    # base_url: set via QUERY_EXPANSION_BASE_URL env var (optional, defaults to VLM's OPENAI_BASE_URL)
    base_url: ""

sources:
  chinesebqb:
    enabled: true
    repo_path: ./data/ChineseBQB
  staging:
    path: ./data/staging
