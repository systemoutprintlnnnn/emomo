server:
  port: 8080
  mode: debug  # debug, release, test
  cors:
    # Set to true to allow all origins (not recommended for production)
    # When true, credentials will be disabled for security
    allow_all_origins: true
    # List of allowed origins (e.g., for Vercel deployment)
    # Example: ["https://your-app.vercel.app", "https://your-custom-domain.com"]
    # Leave empty if allow_all_origins is true
    allowed_origins: []

database:
  driver: sqlite  # sqlite or postgres (可通过 DATABASE_DRIVER 环境变量覆盖)
  path: ./data/memes.db

qdrant:
  host: localhost
  port: 6334
  collection: emomo
  # api_key: 通过环境变量 QDRANT_API_KEY 设置 (Qdrant Cloud 认证)
  # use_tls: 设置了 api_key 时自动启用 TLS，也可通过 QDRANT_USE_TLS 显式设置

# 旧版 MinIO 配置（已废弃，保留用于向后兼容）
# 建议使用下面的 storage 配置
minio:
  endpoint: localhost:9000
  # access_key: 通过环境变量 MINIO_ACCESS_KEY 设置（默认: minioadmin）
  # secret_key: 通过环境变量 MINIO_SECRET_KEY 设置（默认: minioadmin）
  use_ssl: false
  bucket: memes

# 通用存储配置（支持 MinIO、Cloudflare R2、AWS S3）
# 如果配置了 storage，将优先使用；否则回退到上面的 minio 配置（向后兼容）
storage:
  # type: r2                                          # minio, r2, s3
  # endpoint: <account_id>.r2.cloudflarestorage.com   # S3 API endpoint
  # access_key: <r2_access_key>                       # 或通过 STORAGE_ACCESS_KEY 设置
  # secret_key: <r2_secret_key>                       # 或通过 STORAGE_SECRET_KEY 设置
  # use_ssl: true
  # bucket: memes
  # region: auto                                      # R2 使用 "auto"，AWS S3 使用具体 region
  # public_url: https://pub-xxx.r2.dev                # R2.dev 公开访问 URL（推荐配置）

vlm:
  provider: openai
  model: qwen/qwen-2.5-vl-7b-instruct:free
  # api_key: 通过环境变量 OPENAI_API_KEY 设置
  base_url: https://openrouter.ai/api/v1

embedding:
  provider: jina
  model: jina-embeddings-v3
  # api_key: 通过环境变量 JINA_API_KEY 设置
  dimensions: 1024

ingest:
  workers: 5
  batch_size: 10
  retry_count: 3

search:
  score_threshold: 0.0
  query_expansion:
    enabled: true  # Enable LLM-based query expansion for better search results
    model: qwen/qwen-2.5-vl-7b-instruct:free  # Model to use for query expansion (can be overridden by QUERY_EXPANSION_MODEL env var)

sources:
  chinesebqb:
    enabled: true
    repo_path: ./data/ChineseBQB
